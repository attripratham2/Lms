"use strict";(self.webpackChunkleemons_plugin_grades_frontend_react=self.webpackChunkleemons_plugin_grades_frontend_react||[]).push([[828],{"./src/components/ProgramRules/ProgramRules.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Dg:()=>LOGIC_OPERATORS,lN:()=>PROGRAM_RULES_DEFAULT_PROPS,ee:()=>ProgramRules});var react=__webpack_require__("../../../node_modules/react/index.js"),prop_types=__webpack_require__("../../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),create_styles=__webpack_require__("../../../node_modules/@mantine/styles/esm/tss/create-styles.js"),theme_mixins=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/theme.mixins.js");const ProgramRulesStyles=(0,create_styles.k)((theme=>({root:{...(0,theme_mixins.Gi)(theme.fontSizes[2])},gradeSelect:{marginLeft:(0,theme_mixins.Q1)(10)}})));var RuleGroup=__webpack_require__("./src/components/RuleGroup/RuleGroup.js"),v4=__webpack_require__("../../../node_modules/uuid/dist/esm-browser/v4.js"),Box=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/layout/Box/Box.js"),Stack=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/layout/Stack/Stack.js"),TextInput=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/form/TextInput/TextInput.js"),Button=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/form/Button/Button.js"),Select=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/form/Select/Select.js"),Paper=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/layout/Paper/Paper.js"),lodash=__webpack_require__("../../../node_modules/lodash/lodash.js"),jsx_runtime=__webpack_require__("../../../node_modules/react/jsx-runtime.js");const PROPTYPES_SHAPE=prop_types_default().shape({label:prop_types_default().string,value:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().number])}),LOGIC_OPERATORS=[{label:"AND",value:"and"},{label:"OR",value:"or"}],PROGRAM_RULES_DEFAULT_PROPS={},PROGRAM_RULES_PROP_TYPES={programs:prop_types_default().arrayOf(PROPTYPES_SHAPE),grades:prop_types_default().arrayOf(PROPTYPES_SHAPE),gradeSystem:prop_types_default().arrayOf(PROPTYPES_SHAPE),sources:prop_types_default().arrayOf(PROPTYPES_SHAPE),courses:prop_types_default().arrayOf(PROPTYPES_SHAPE),knowledges:prop_types_default().arrayOf(PROPTYPES_SHAPE),subjects:prop_types_default().arrayOf(PROPTYPES_SHAPE),subjectTypes:prop_types_default().arrayOf(PROPTYPES_SHAPE),subjectGroups:prop_types_default().arrayOf(PROPTYPES_SHAPE),dataTypes:prop_types_default().arrayOf(PROPTYPES_SHAPE),operators:prop_types_default().arrayOf(PROPTYPES_SHAPE),onChange:prop_types_default().func,errorMessage:prop_types_default().string,labels:prop_types_default().shape({saveButton:prop_types_default().string,newRule:prop_types_default().string,newRuleGroup:prop_types_default().string,menuLabels:prop_types_default().shape({remove:prop_types_default().string,duplicate:prop_types_default().string,turnIntoCondition:prop_types_default().string,turnIntoGroup:prop_types_default().string}),where:prop_types_default().string}),placeholders:prop_types_default().shape({programName:prop_types_default().string,selectProgram:prop_types_default().string,selectGradeSystem:prop_types_default().string,conditionPlaceholders:prop_types_default().shape({selectItem:prop_types_default().string,selectCourse:prop_types_default().string,selectKnowledge:prop_types_default().string,selectSubject:prop_types_default().string,selectSubjectType:prop_types_default().string,selectSubjectGroup:prop_types_default().string,selectDataType:prop_types_default().string,selectOperator:prop_types_default().string,selectTargetGrade:prop_types_default().string})})},ProgramRules=_ref=>{let{programs,grades,gradeSystems,sources,courses,knowledges,subjects,subjectTypes,subjectGroups,dataTypes,operators,onChange,errorMessage,labels,placeholders,...props}=_ref;const{classes,cx}=ProgramRulesStyles({}),[data,setData]=(0,react.useState)({name:"",program:"",grade:"",group:{operator:LOGIC_OPERATORS[0].value,conditions:[{id:(0,v4.Z)(),source:"",sourceIds:[],data:"",operator:"",target:0}]}}),[nameValue,setNameValue]=(0,react.useState)(""),[program,setProgram]=(0,react.useState)(null),[gradeSystem,setGradeSystem]=(0,react.useState)(""),[edited,setEdited]=(0,react.useState)([]),[error,setError]=(0,react.useState)(!1);return(0,jsx_runtime.jsxs)(Box.xu,{className:classes.root,children:[(0,jsx_runtime.jsxs)(Stack.Kq,{justifyContent:"space-between",fullWidth:!0,children:[(0,jsx_runtime.jsx)(TextInput.oi,{placeholder:placeholders.programName,value:nameValue,onChange:e=>{setNameValue(e),setData({...data,name:e})}}),(0,jsx_runtime.jsx)(Button.zx,{onClick:()=>(data=>{0===edited.filter((item=>!1===item.value)).length?(setError(!1),(0,lodash.isFunction)(onChange)&&onChange(data)):setError(!0)})(data),children:labels.saveButton})]}),(0,jsx_runtime.jsxs)(Stack.Kq,{fullWidth:!0,children:[(0,jsx_runtime.jsx)(Select.P,{data:programs,placeholder:placeholders.selectProgram,onChange:e=>{setProgram(programs.find((obj=>obj.value===e))),setData({...data,program:e})}}),(0,jsx_runtime.jsx)(Select.P,{data:gradeSystems,placeholder:placeholders.selectGradeSystem,className:classes.gradeSelect,onChange:e=>{setData({...data,grade:e}),setGradeSystem(e)}})]}),(0,jsx_runtime.jsx)(Paper.Xk,{fullWidth:!0,padding:3,children:(0,jsx_runtime.jsx)(RuleGroup.bu,{program,grades,gradeSystem,sources,courses,knowledges,subjects,subjectTypes,subjectGroups,dataTypes,operators,group:data.group,data,setData,edited,setEdited,error,setError,errorMessage,labels:{newRule:labels.newRule,newRuleGroup:labels.newRuleGroup,menuLabels:labels.menuLabels,where:labels.where},placeholders:placeholders.conditionPlaceholders})})]})};ProgramRules.displayName="ProgramRules",ProgramRules.defaultProps=PROGRAM_RULES_DEFAULT_PROPS,ProgramRules.propTypes=PROGRAM_RULES_PROP_TYPES,ProgramRules.__docgenInfo={description:"",methods:[],displayName:"ProgramRules",props:{programs:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},grades:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},gradeSystem:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},sources:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},courses:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},knowledges:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},subjects:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},subjectTypes:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},subjectGroups:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},dataTypes:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},operators:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},onChange:{description:"",type:{name:"func"},required:!1},errorMessage:{description:"",type:{name:"string"},required:!1},labels:{description:"",type:{name:"shape",value:{saveButton:{name:"string",required:!1},newRule:{name:"string",required:!1},newRuleGroup:{name:"string",required:!1},menuLabels:{name:"shape",value:{remove:{name:"string",required:!1},duplicate:{name:"string",required:!1},turnIntoCondition:{name:"string",required:!1},turnIntoGroup:{name:"string",required:!1}},required:!1},where:{name:"string",required:!1}}},required:!1},placeholders:{description:"",type:{name:"shape",value:{programName:{name:"string",required:!1},selectProgram:{name:"string",required:!1},selectGradeSystem:{name:"string",required:!1},conditionPlaceholders:{name:"shape",value:{selectItem:{name:"string",required:!1},selectCourse:{name:"string",required:!1},selectKnowledge:{name:"string",required:!1},selectSubject:{name:"string",required:!1},selectSubjectType:{name:"string",required:!1},selectSubjectGroup:{name:"string",required:!1},selectDataType:{name:"string",required:!1},selectOperator:{name:"string",required:!1},selectTargetGrade:{name:"string",required:!1}},required:!1}}},required:!1}}}},"./src/components/ProgramRules/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Dg:()=>_ProgramRules__WEBPACK_IMPORTED_MODULE_0__.Dg});var _ProgramRules__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/components/ProgramRules/ProgramRules.js")},"./src/components/RuleCondition/RuleCondition.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{SJ:()=>RULE_CONDITION_DEFAULT_PROPS,QJ:()=>RuleCondition});var react=__webpack_require__("../../../node_modules/react/index.js"),prop_types=__webpack_require__("../../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react_beautiful_dnd_esm=__webpack_require__("../../../node_modules/react-beautiful-dnd/dist/react-beautiful-dnd.esm.js"),v4=__webpack_require__("../../../node_modules/uuid/dist/esm-browser/v4.js"),lodash=__webpack_require__("../../../node_modules/lodash/lodash.js"),MultiSelect=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/form/MultiSelect/MultiSelect.js"),Text=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/typography/Text/Text.js"),Select=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/form/Select/Select.js"),Box=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/layout/Box/Box.js"),Paper=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/layout/Paper/Paper.js"),Stack=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/layout/Stack/Stack.js"),TextInput=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/form/TextInput/TextInput.js"),NumberInput=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/form/NumberInput/NumberInput.js"),Menu=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/navigation/Menu/Menu.js"),esm=__webpack_require__("../../../node_modules/@bubbles-ui/icons/solid/esm/index.js"),outline_esm=__webpack_require__("../../../node_modules/@bubbles-ui/icons/outline/esm/index.js"),ProgramRules=__webpack_require__("./src/components/ProgramRules/index.js"),create_styles=__webpack_require__("../../../node_modules/@mantine/styles/esm/tss/create-styles.js"),theme_mixins=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/theme.mixins.js");const RuleConditionStyles=(0,create_styles.k)((theme=>({root:{display:"flex",alignItems:"baseline",gap:theme.spacing[1],marginBottom:theme.spacing[1]},logicOperator:{width:(0,theme_mixins.Q1)(80)},sourceSelects:{display:"flex",gap:theme.spacing[1]}})));var jsx_runtime=__webpack_require__("../../../node_modules/react/jsx-runtime.js");const PROPTYPES_SHAPE=prop_types_default().shape({label:prop_types_default().string,value:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().number])}),RULE_CONDITION_DEFAULT_PROPS={},RULE_CONDITION_PROP_TYPES={program:PROPTYPES_SHAPE,grades:prop_types_default().arrayOf(PROPTYPES_SHAPE),sources:prop_types_default().arrayOf(PROPTYPES_SHAPE),courses:prop_types_default().arrayOf(PROPTYPES_SHAPE),knowledges:prop_types_default().arrayOf(PROPTYPES_SHAPE),subjects:prop_types_default().arrayOf(PROPTYPES_SHAPE),subjectTypes:prop_types_default().arrayOf(PROPTYPES_SHAPE),subjectGroups:prop_types_default().arrayOf(PROPTYPES_SHAPE),dataTypes:prop_types_default().arrayOf(PROPTYPES_SHAPE),operators:prop_types_default().arrayOf(PROPTYPES_SHAPE),logicOperator:PROPTYPES_SHAPE,setLogicOperator:prop_types_default().func,index:prop_types_default().number,draggableId:prop_types_default().string,data:prop_types_default().object,setData:prop_types_default().func,condition:prop_types_default().object,group:prop_types_default().object,edited:prop_types_default().array,setEdited:prop_types_default().func,error:prop_types_default().bool,labels:prop_types_default().shape({menuLabels:prop_types_default().shape({remove:prop_types_default().string,duplicate:prop_types_default().string,turnIntoCondition:prop_types_default().string,turnIntoGroup:prop_types_default().string}),where:prop_types_default().string}),placeholders:prop_types_default().shape({selectItem:prop_types_default().string,selectCourse:prop_types_default().string,selectKnowledge:prop_types_default().string,selectSubject:prop_types_default().string,selectSubjectType:prop_types_default().string,selectSubjectGroup:prop_types_default().string,selectDataType:prop_types_default().string,selectOperator:prop_types_default().string,selectTargetGrade:prop_types_default().string})},RuleCondition=_ref=>{let{program,grades,gradeSystem,sources,courses,knowledges,subjects,subjectTypes,subjectGroups,dataTypes,operators,logicOperator,setLogicOperator,index,draggableId,data,setData,condition,group,edited,setEdited,error,setError,errorMessage,labels,placeholders,...props}=_ref;const{classes,cx}=RuleConditionStyles({},{name:"RuleCondition"}),[sourceValue,setSourceValue]=(0,react.useState)(condition.source||""),[sourceIdsValue,setSourceIdsValue]=(0,react.useState)(condition.sourceIds||[]),[dataType,setDataType]=(0,react.useState)(condition.data||""),[operatorValue,setOperatorValue]=(0,react.useState)(condition.operator||""),[targetValue,setTargetValue]=(0,react.useState)(condition.target||""),isFirstRenderRef=(0,react.useRef)(!0),setNewData=(e,field)=>{"source"===field&&(condition[field]=e,condition.sourceIds=[],setSourceIdsValue([]),"program"===e&&(condition.sourceIds=[program.value],setSourceIdsValue([program.value]))),"sourceIds"===field&&setSourceIdsValue(e),"data"===field&&"enrolled"===e&&(delete condition.target,delete condition.operator),("operator"!==field&&"target"!==field||"enrolled"!==condition.data)&&(condition[field]=e,setData({...data}))},getSourceSelect=value=>{switch(value){case"course":return(0,jsx_runtime.jsx)(MultiSelect.N,{data:courses,placeholder:placeholders.selectCourse,value:sourceIdsValue,onChange:e=>setNewData(e,"sourceIds")});case"knowledge":return(0,jsx_runtime.jsx)(MultiSelect.N,{data:knowledges,placeholder:placeholders.selectKnowledge,value:sourceIdsValue,onChange:e=>setNewData(e,"sourceIds")});case"subject":return(0,jsx_runtime.jsx)(MultiSelect.N,{data:subjects,placeholder:placeholders.selectSubject,value:sourceIdsValue,onChange:e=>setNewData(e,"sourceIds")});case"subject-type":return(0,jsx_runtime.jsx)(MultiSelect.N,{data:subjectTypes,placeholder:placeholders.selectSubjectType,value:sourceIdsValue,onChange:e=>setNewData(e,"sourceIds")});case"subject-group":return(0,jsx_runtime.jsx)(MultiSelect.N,{data:subjectGroups,placeholder:placeholders.selectSubjectGroup,value:sourceIdsValue,onChange:e=>setNewData(e,"sourceIds")});default:return null}},getLogicOperatorSelect=()=>0===index?(0,jsx_runtime.jsx)(Text.xv,{role:"productive",children:labels.where}):1===index?(0,jsx_runtime.jsx)(Select.P,{data:ProgramRules.Dg||[],value:logicOperator.value,onChange:e=>{var value;setLogicOperator({label:e.toUpperCase(),value:e}),value=e,group.operator=value,setData({...data})}}):(0,jsx_runtime.jsx)(Box.xu,{m:10,children:(0,jsx_runtime.jsx)(Text.xv,{role:"productive",children:logicOperator.label})}),isTargetValid=()=>"enrolled"===dataType||""!==targetValue&&(!(0===targetValue||targetValue<0)&&(null!=targetValue&&"0"!==targetValue)),removeCondition=()=>{group.conditions.splice(index,1),setData({...data})},duplicateCondition=()=>{group.conditions.push({...condition,id:(0,v4.Z)()}),setData({...data})},turnToGroup=()=>{group.conditions.splice(index,1,{id:(0,v4.Z)(),group:{operator:"and",conditions:[condition]}}),setData({...data})},resetValues=withDataType=>{withDataType&&(setDataType(""),setNewData("","data")),setOperatorValue(""),setTargetValue(0),setNewData("","operator"),setNewData(0,"target")},filteredDataTypes=(0,react.useMemo)((()=>{let results=[];if(sourceValue&&dataTypes){let filters=[];switch(sourceValue){case"program":filters=["cpp","cpc","gpa"];break;case"course":filters=["cpc","gpa"];break;case"knowledge":case"subject-type":filters=["cpp","cpc","gpa","cpcg"];break;case"subject":filters=["grade","enrolled"];break;case"subject-group":filters=["gpa","credits"]}results=(0,lodash.filter)(dataTypes,(item=>filters.includes(item.value)))}return results}),[sourceValue,dataTypes]);return(0,react.useEffect)((()=>{isFirstRenderRef.current||(setTargetValue(0),setNewData(0,"target"))}),[gradeSystem]),(0,react.useEffect)((()=>{edited&&setEdited(edited.map((item=>item.id===draggableId?isTargetValid()?(item.value=!0,item):(item.value=!1,item):item)))}),[targetValue,dataType]),(0,react.useEffect)((()=>{0===edited.filter((item=>!1===item.value)).length&&setError(!1)}),[edited]),(0,react.useEffect)((()=>{"program"===sourceValue&&condition.sourceIds[0]!==program.value&&(condition.sourceIds=[program.value],setSourceIdsValue([program.value]),setData({...data}))}),[program,sourceValue]),(0,react.useEffect)((()=>{isTargetValid()?setEdited([...edited,{id:draggableId,value:!0}]):setEdited([...edited,{id:draggableId,value:!1}]),isFirstRenderRef.current=!1}),[]),(0,jsx_runtime.jsx)(react_beautiful_dnd_esm._l,{draggableId,index,children:(provided,snapshot)=>(0,jsx_runtime.jsx)(Paper.Xk,{fullWidth:!0,padding:"none",shadow:"none",ref:provided.innerRef,...provided.draggableProps,...provided.dragHandleProps,children:(0,jsx_runtime.jsxs)(Box.xu,{className:classes.root,children:[(0,jsx_runtime.jsx)(Box.xu,{className:classes.logicOperator,children:getLogicOperatorSelect()}),(0,jsx_runtime.jsxs)(Stack.Kq,{fullWidth:!0,spacing:1,children:[(0,jsx_runtime.jsx)(Select.P,{data:sources||[],placeholder:placeholders.selectItem,value:sourceValue,onChange:e=>{setSourceValue(e),setNewData(e,"source"),resetValues(!0)},disabled:!program,skipFlex:!0}),sourceValue&&getSourceSelect(sourceValue),(0,jsx_runtime.jsx)(Select.P,{data:filteredDataTypes||[],placeholder:placeholders.selectDataType,value:dataType,onChange:e=>{setDataType(e),setNewData(e,"data"),resetValues()},disabled:!sourceValue||"program"!==sourceValue&&0===sourceIdsValue.length,skipFlex:!0}),"enrolled"!==dataType&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Select.P,{data:operators||[],placeholder:placeholders.selectOperator,value:operatorValue,onChange:e=>{setOperatorValue(e),setNewData(e,"operator"),setTargetValue(0),setNewData(0,"target")},disabled:!dataType}),"gpa"===dataType||"grade"===dataType?(0,jsx_runtime.jsx)(Select.P,{data:grades||[],placeholder:placeholders.selectTargetGrade,value:targetValue,onChange:e=>{setTargetValue(e),setNewData(e,"target")},disabled:!operatorValue||!gradeSystem,error:error?errorMessage||"Please select a grade":null,required:!0}):"contains"===operatorValue?(0,jsx_runtime.jsx)(TextInput.oi,{placeholder:placeholders.enterTarget,value:targetValue,onChange:e=>{setTargetValue(e),setNewData(e,"target")},disabled:!operatorValue||!gradeSystem,error:error?errorMessage||"Please select a grade":null,required:!0}):(0,jsx_runtime.jsx)(NumberInput.Y2,{placeholder:placeholders.enterTarget,defaultValue:0,value:targetValue,onChange:e=>{setTargetValue(e),setNewData(e,"target")},disabled:!operatorValue||!gradeSystem,error:error?errorMessage||"Please select a grade":null,required:!0})]})]}),(0,jsx_runtime.jsx)(Menu.v2,{items:[{children:labels.menuLabels.remove,icon:(0,jsx_runtime.jsx)(esm.Fg,{}),onClick:removeCondition},{children:labels.menuLabels.duplicate,icon:(0,jsx_runtime.jsx)(outline_esm.NAN,{}),onClick:duplicateCondition},{children:labels.menuLabels.turnIntoGroup,icon:(0,jsx_runtime.jsx)(outline_esm.aK0,{}),onClick:turnToGroup}]})]})})})};RuleCondition.displayName="RuleCondition",RuleCondition.defaultProps=RULE_CONDITION_DEFAULT_PROPS,RuleCondition.propTypes=RULE_CONDITION_PROP_TYPES,RuleCondition.__docgenInfo={description:"",methods:[],displayName:"RuleCondition",props:{program:{description:"",type:{name:"custom",raw:"PROPTYPES_SHAPE"},required:!1},grades:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},sources:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},courses:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},knowledges:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},subjects:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},subjectTypes:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},subjectGroups:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},dataTypes:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},operators:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},logicOperator:{description:"",type:{name:"custom",raw:"PROPTYPES_SHAPE"},required:!1},setLogicOperator:{description:"",type:{name:"func"},required:!1},index:{description:"",type:{name:"number"},required:!1},draggableId:{description:"",type:{name:"string"},required:!1},data:{description:"",type:{name:"object"},required:!1},setData:{description:"",type:{name:"func"},required:!1},condition:{description:"",type:{name:"object"},required:!1},group:{description:"",type:{name:"object"},required:!1},edited:{description:"",type:{name:"array"},required:!1},setEdited:{description:"",type:{name:"func"},required:!1},error:{description:"",type:{name:"bool"},required:!1},labels:{description:"",type:{name:"shape",value:{menuLabels:{name:"shape",value:{remove:{name:"string",required:!1},duplicate:{name:"string",required:!1},turnIntoCondition:{name:"string",required:!1},turnIntoGroup:{name:"string",required:!1}},required:!1},where:{name:"string",required:!1}}},required:!1},placeholders:{description:"",type:{name:"shape",value:{selectItem:{name:"string",required:!1},selectCourse:{name:"string",required:!1},selectKnowledge:{name:"string",required:!1},selectSubject:{name:"string",required:!1},selectSubjectType:{name:"string",required:!1},selectSubjectGroup:{name:"string",required:!1},selectDataType:{name:"string",required:!1},selectOperator:{name:"string",required:!1},selectTargetGrade:{name:"string",required:!1}}},required:!1}}}},"./src/components/RuleGroup/RuleGroup.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{IS:()=>RULE_GROUP_DEFAULT_PROPS,bu:()=>RuleGroup});var react=__webpack_require__("../../../node_modules/react/index.js"),prop_types=__webpack_require__("../../../node_modules/prop-types/index.js"),prop_types_default=__webpack_require__.n(prop_types),react_beautiful_dnd_esm=__webpack_require__("../../../node_modules/react-beautiful-dnd/dist/react-beautiful-dnd.esm.js"),v4=__webpack_require__("../../../node_modules/uuid/dist/esm-browser/v4.js"),esm=__webpack_require__("../../../node_modules/@bubbles-ui/icons/solid/esm/index.js"),outline_esm=__webpack_require__("../../../node_modules/@bubbles-ui/icons/outline/esm/index.js"),Text=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/typography/Text/Text.js"),Select=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/form/Select/Select.js"),Box=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/layout/Box/Box.js"),Stack=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/layout/Stack/Stack.js"),Button=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/form/Button/Button.js"),Paper=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/layout/Paper/Paper.js"),Menu=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/navigation/Menu/Menu.js"),RuleCondition=__webpack_require__("./src/components/RuleCondition/RuleCondition.js"),ProgramRules=__webpack_require__("./src/components/ProgramRules/index.js"),create_styles=__webpack_require__("../../../node_modules/@mantine/styles/esm/tss/create-styles.js"),theme_mixins=__webpack_require__("../../../node_modules/@bubbles-ui/components/es/theme.mixins.js");const RuleGroupStyles=(0,create_styles.k)((theme=>({root:{padding:(0,theme_mixins.Q1)(8)},draggableGroup:{border:`1px solid ${theme.colors.ui01}`,flex:1,marginBottom:theme.spacing[2]},logicOperator:{width:(0,theme_mixins.Q1)(80)},input:{},ruleGroup:{display:"flex",gap:theme.spacing[1]}})));var jsx_runtime=__webpack_require__("../../../node_modules/react/jsx-runtime.js");const PROPTYPES_SHAPE=prop_types_default().shape({label:prop_types_default().string,value:prop_types_default().oneOfType([prop_types_default().string,prop_types_default().number])}),RULE_GROUP_DEFAULT_PROPS={},RULE_GROUP_PROP_TYPES={program:PROPTYPES_SHAPE,grades:prop_types_default().arrayOf(PROPTYPES_SHAPE),sources:prop_types_default().arrayOf(PROPTYPES_SHAPE),courses:prop_types_default().arrayOf(PROPTYPES_SHAPE),knowledges:prop_types_default().arrayOf(PROPTYPES_SHAPE),subjects:prop_types_default().arrayOf(PROPTYPES_SHAPE),subjectTypes:prop_types_default().arrayOf(PROPTYPES_SHAPE),subjectGroups:prop_types_default().arrayOf(PROPTYPES_SHAPE),dataTypes:prop_types_default().arrayOf(PROPTYPES_SHAPE),operators:prop_types_default().arrayOf(PROPTYPES_SHAPE),index:prop_types_default().number,draggableId:prop_types_default().string,className:prop_types_default().string,parentOperator:PROPTYPES_SHAPE,setParentOperator:prop_types_default().func,parentGroup:prop_types_default().object,group:prop_types_default().object,data:prop_types_default().object,setData:prop_types_default().func,edited:prop_types_default().array,setEdited:prop_types_default().func,error:prop_types_default().bool,setError:prop_types_default().func,errorMessage:prop_types_default().string,labels:prop_types_default().shape({newRule:prop_types_default().string,newRuleGroup:prop_types_default().string,menuLabels:prop_types_default().shape({remove:prop_types_default().string,duplicate:prop_types_default().string,turnIntoCondition:prop_types_default().string,turnIntoGroup:prop_types_default().string}),where:prop_types_default().string}),placeholders:prop_types_default().shape({selectItem:prop_types_default().string,selectCourse:prop_types_default().string,selectKnowledge:prop_types_default().string,selectSubject:prop_types_default().string,selectSubjectType:prop_types_default().string,selectSubjectGroup:prop_types_default().string,selectDataType:prop_types_default().string,selectOperator:prop_types_default().string,selectTargetGrade:prop_types_default().string})},RuleGroup=_ref=>{let{program,grades,gradeSystem,sources,courses,knowledges,subjects,subjectTypes,subjectGroups,dataTypes,operators,index,draggableId,className,parentOperator,setParentOperator,parentGroup,group,data,setData,edited,setEdited,error,setError,errorMessage,labels,placeholders,...props}=_ref;const{classes,cx}=RuleGroupStyles({},{name:"RuleGroup"}),[logicOperator,setLogicOperator]=(0,react.useState)(ProgramRules.Dg[0]),getLogicOperatorSelect=()=>0===index?(0,jsx_runtime.jsx)(Text.xv,{role:"productive",children:labels.where}):1===index?(0,jsx_runtime.jsx)(Select.P,{className:classes.input,data:ProgramRules.Dg,value:parentOperator.value,onChange:e=>{var value;setParentOperator({label:e.toUpperCase(),value:e}),value=e,parentGroup.operator=value,setData({...data})}}):(0,jsx_runtime.jsx)(Box.xu,{m:10,children:(0,jsx_runtime.jsx)(Text.xv,{role:"productive",children:parentOperator.label})}),removeGroup=()=>{parentGroup.conditions.splice(index,1),setData({...data})},duplicateGroup=()=>{parentGroup.conditions.push({id:(0,v4.Z)(),group:{operator:group.operator,conditions:group.conditions.map((condition=>({...condition,id:(0,v4.Z)()})))}}),setData({...data})},turnToCondition=()=>{parentGroup.conditions.splice(index,1),parentGroup.conditions.push(...group.conditions),setData({...data})},uuid=(0,v4.Z)(),ruleGroup=(0,jsx_runtime.jsxs)(Box.xu,{className:classes.root,children:[(0,jsx_runtime.jsx)(react_beautiful_dnd_esm.Z5,{onDragEnd:_ref2=>{let{source,destination}=_ref2;if(!destination)return;const[removed]=group.conditions.splice(source.index,1);group.conditions.splice(destination.index,0,removed),setData({...data})},children:(0,jsx_runtime.jsx)(react_beautiful_dnd_esm.bK,{droppableId:uuid,children:(provided,snapshot)=>(0,jsx_runtime.jsxs)(Box.xu,{...provided.droppableProps,ref:provided.innerRef,children:[group.conditions.map(((condition,index)=>condition.group?(0,jsx_runtime.jsx)(RuleGroup,{program,grades,gradeSystem,sources,courses,knowledges,subjects,subjectTypes,subjectGroups,dataTypes,operators,draggableId:condition.id,index,className:classes.draggableGroup,parentOperator:logicOperator,setParentOperator:setLogicOperator,parentGroup:group,group:condition.group,data,setData,edited,setEdited,error,setError,errorMessage,labels,placeholders},condition.id):(0,jsx_runtime.jsx)(RuleCondition.QJ,{program,grades,gradeSystem,sources,courses,knowledges,subjects,subjectTypes,subjectGroups,dataTypes,operators,logicOperator,setLogicOperator,index,draggableId:condition.id,data,setData,group,condition,edited,setEdited,error,setError,errorMessage,labels:{menuLabels:labels.menuLabels,where:labels.where},placeholders},condition.id))),provided.placeholder]})})}),(0,jsx_runtime.jsxs)(Stack.Kq,{direction:"column",alignItems:"start",children:[(0,jsx_runtime.jsx)(Button.zx,{variant:"light",compact:!0,size:"xs",leftIcon:(0,jsx_runtime.jsx)(outline_esm.agZ,{}),onClick:()=>{group.conditions.push({id:(0,v4.Z)(),source:"",sourceIds:[],data:"",operator:"",target:0}),setData({...data})},children:labels.newRule}),(0,jsx_runtime.jsx)(Button.zx,{variant:"light",compact:!0,size:"xs",leftIcon:(0,jsx_runtime.jsx)(outline_esm.agZ,{}),onClick:()=>{group.conditions.push({id:(0,v4.Z)(),group:{operator:ProgramRules.Dg[0].value,conditions:[{id:(0,v4.Z)(),source:"",sourceIds:[],data:"",operator:"",target:0}]}}),setData({...data})},children:labels.newRuleGroup})]})]});return draggableId?(0,jsx_runtime.jsx)(react_beautiful_dnd_esm._l,{draggableId,index,children:(provided,snapshot)=>(0,jsx_runtime.jsx)(Box.xu,{...provided.draggableProps,...provided.dragHandleProps,ref:provided.innerRef,children:(0,jsx_runtime.jsxs)(Box.xu,{className:classes.ruleGroup,children:[(0,jsx_runtime.jsx)(Box.xu,{className:classes.logicOperator,children:getLogicOperatorSelect()}),(0,jsx_runtime.jsx)(Paper.Xk,{fullWidth:!0,className,padding:3,children:ruleGroup}),(0,jsx_runtime.jsx)(Menu.v2,{items:[{children:labels.menuLabels.remove,icon:(0,jsx_runtime.jsx)(esm.Fg,{}),onClick:removeGroup},{children:labels.menuLabels.duplicate,icon:(0,jsx_runtime.jsx)(outline_esm.NAN,{}),onClick:duplicateGroup},{children:labels.menuLabels.turnIntoCondition,icon:(0,jsx_runtime.jsx)(outline_esm.aK0,{}),onClick:turnToCondition}]})]})})}):ruleGroup};RuleGroup.defaultProps=RULE_GROUP_DEFAULT_PROPS,RuleGroup.propTypes=RULE_GROUP_PROP_TYPES,RuleGroup.__docgenInfo={description:"",methods:[],displayName:"RuleGroup",props:{program:{description:"",type:{name:"custom",raw:"PROPTYPES_SHAPE"},required:!1},grades:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},sources:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},courses:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},knowledges:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},subjects:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},subjectTypes:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},subjectGroups:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},dataTypes:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},operators:{description:"",type:{name:"arrayOf",value:{name:"custom",raw:"PROPTYPES_SHAPE"}},required:!1},index:{description:"",type:{name:"number"},required:!1},draggableId:{description:"",type:{name:"string"},required:!1},className:{description:"",type:{name:"string"},required:!1},parentOperator:{description:"",type:{name:"custom",raw:"PROPTYPES_SHAPE"},required:!1},setParentOperator:{description:"",type:{name:"func"},required:!1},parentGroup:{description:"",type:{name:"object"},required:!1},group:{description:"",type:{name:"object"},required:!1},data:{description:"",type:{name:"object"},required:!1},setData:{description:"",type:{name:"func"},required:!1},edited:{description:"",type:{name:"array"},required:!1},setEdited:{description:"",type:{name:"func"},required:!1},error:{description:"",type:{name:"bool"},required:!1},setError:{description:"",type:{name:"func"},required:!1},errorMessage:{description:"",type:{name:"string"},required:!1},labels:{description:"",type:{name:"shape",value:{newRule:{name:"string",required:!1},newRuleGroup:{name:"string",required:!1},menuLabels:{name:"shape",value:{remove:{name:"string",required:!1},duplicate:{name:"string",required:!1},turnIntoCondition:{name:"string",required:!1},turnIntoGroup:{name:"string",required:!1}},required:!1},where:{name:"string",required:!1}}},required:!1},placeholders:{description:"",type:{name:"shape",value:{selectItem:{name:"string",required:!1},selectCourse:{name:"string",required:!1},selectKnowledge:{name:"string",required:!1},selectSubject:{name:"string",required:!1},selectSubjectType:{name:"string",required:!1},selectSubjectGroup:{name:"string",required:!1},selectDataType:{name:"string",required:!1},selectOperator:{name:"string",required:!1},selectTargetGrade:{name:"string",required:!1}}},required:!1}}}}}]);